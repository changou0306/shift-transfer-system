# Shift Transfer System (シフト転記システム)

Google Apps Scriptを使用したシフトデータの自動転記システムです。複数のスタッフのシフト情報を効率的に個人用スプレッドシートに転記します。

## 概要

このシステムは、マスタースプレッドシートから各スタッフの個人用スプレッドシートへシフト情報を自動的に転記します。最大70人の同時処理にも対応できるよう、パフォーマンスが最適化されています。

## 主な機能

- **シフトデータの自動転記**: マスターシートから個人シートへの一括転記
- **カスタムプロジェクト対応**: プロジェクト名に応じた詳細情報の自動付与
- **リソース・店舗情報の自動付与**: シフトに関連する会場・内容情報の追加
- **OJTデータの転記**: 研修情報の自動反映
- **既存データの保持**: 補足事項と稼働時間の保護

## パフォーマンス最適化

このシステムは以下の最適化により、高速な処理を実現しています：

### 最適化前
- 2人同時処理: 約40秒
- 1人あたり: 約20秒
- 70人同時処理: 約2800秒（47分）

### 最適化後
- 2人同時処理: 約8-10秒
- 1人あたり: 約4-5秒
- 70人同時処理: 約350秒（6分）

### 最適化手法
1. **スプレッドシートキャッシング**: `SpreadsheetApp.openById()`の呼び出しを削減
2. **カスタムプロジェクトデータの事前読み込み**: シート読み込みを1回に集約
3. **メンバー情報の一括取得**: マスターシートへのアクセスを最小化
4. **一括データ読み込み**: 31回の個別読み込みを2回の一括読み込みに削減

## ファイル構成

- `tenki.js`: メインの転記処理スクリプト（ES6+で記述）
- `sample.js`: オリジナルのバックアップファイル
- `sample_refactored.js`: リファクタリング版（旧バージョン）

## 技術仕様

- **言語**: JavaScript (ES6+)
- **プラットフォーム**: Google Apps Script (V8ランタイム)
- **主要API**: SpreadsheetApp, Logger

## 使用方法

1. Google Apps Scriptエディタでプロジェクトを開く
2. `tenki.js`のコードを配置
3. V8ランタイムが有効になっていることを確認
4. 必要な権限を承認
5. マスターシートから転記処理を実行

## 設定

システムの動作は`CONFIG`オブジェクトで制御されています：

- シート名の設定
- 列番号の定義
- 行番号の定義
- カラーコードの設定

## 開発履歴

- **v1.0**: 初期リリース
- **v2.0**: ES6+リファクタリング（const/let、アロー関数、テンプレートリテラル）
- **v3.0**: パフォーマンス最適化（キャッシング、一括処理）

## ライセンス

本プロジェクトは私的利用を目的としています。

## 貢献

このプロジェクトは個人プロジェクトですが、改善提案やバグレポートは歓迎します。

---

**注意**: このシステムはGoogle Apps Scriptの制限（実行時間、APIコール制限など）に従います。大規模な処理を行う場合は、適切なエラーハンドリングとリトライ機構の実装を推奨します。
